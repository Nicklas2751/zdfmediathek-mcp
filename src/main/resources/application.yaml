spring:
  application:
    name: zdfmediathek-mcp

  ai:
    mcp:
      server:
        enabled: true
        name: zdf-mediathek-mcp
        # Transport modes: streamable (HTTP) or stdio (stdin/stdout)
        # Note: Only one transport can be active at a time
        # Default: streamable (HTTP on port 8080)
        # Set SPRING_AI_MCP_SERVER_STDIO=true to use stdio transport
        protocol: streamable
        stdio: false
        streamable-http:
          mcp-endpoint: /

  security:
    oauth2:
      client:
        registration:
          zdf:
            client-id: ${zdf.client.id}
            client-secret: ${zdf.client.secret}
            client-authentication-method: client_secret_post
            authorization-grant-type: client_credentials
        provider:
          zdf:
            token-uri: ${zdf.url}/oauth/token

# Management endpoints for health checks (for container orchestration)
management:
  endpoints:
    web:
      exposure:
        include: health,info
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized
      probes:
        enabled: true
  health:
    livenessState:
      enabled: true
    readinessState:
      enabled: true

zdf:
  url: https://prod-api.zdf.de
  client:
    id: mediathek-search
    secret: ZDFmediathekSearchClientSecret

logging:
  level:
    root: INFO
    eu.wiegandt.zdfmediathekmcp: DEBUG
    org.springframework.security.oauth2: DEBUG
    org.springframework.web.reactive.function.client: DEBUG
    org.springaicommunity.mcp: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p [%t] %-40.40logger{39} : %m%n%wEx"

---
# Stdio Profile
# Activate with: -Dspring.profiles.active=stdio or SPRING_PROFILES_ACTIVE=stdio
# This profile configures stdio transport and prevents any console output
# which would interfere with MCP communication over stdin/stdout
spring:
  config:
    activate:
      on-profile: stdio
  main:
    banner-mode: off  # Disable Spring Boot banner
  ai:
    mcp:
      server:
        stdio: true  # Enable stdio transport
        protocol: streamable  # Keep protocol as streamable (stdio uses it internally)

logging:
  file:
    name: logs/zdfmediathek-mcp.log
  level:
    root: INFO
    eu.wiegandt.zdfmediathekmcp: DEBUG
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p [%t] %-40.40logger{39} : %m%n%wEx"
    # Note: No console pattern defined - console logging is disabled via logback-spring.xml
