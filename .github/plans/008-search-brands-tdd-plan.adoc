= TDD-Plan: list_brands Feature
:toc: left
:toclevels: 3
:sectnums:

== Überblick

Implementierung eines MCP-Tools `list_brands`, das es ermöglicht, alle TV-Marken/Serien ("Brands") in der ZDF Mediathek aufzulisten.

== Motivation

* Nutzer/LLMs möchten eine Übersicht aller Sendungsreihen, Marken oder Serien erhalten (z.B. "Terra X", "Tatort", "heute-show").
* Ermöglicht die Identifikation und Auswahl von Serien für weitere Abfragen (z.B. Details, Episoden).
* Ergänzt die bestehenden Such- und Schedule-Tools um eine strukturierte Markensuche.

== API-Design

=== MCP Tool Signatur

[source,kotlin]
----
@Tool(
    name = "list_brands",
    description = "List all TV brands/series in the ZDF Mediathek. Returns a list of brands with title, id, and description. " +
                 "Parameters: limit (optional, default: 10). "
)
fun listBrands(limit: Int = 10): List<BrandSummary>
----

=== Parameter

* `limit` (Int, optional, default: 10): Maximale Anzahl der Ergebnisse

=== Rückgabewert

Liste von `BrandSummary` Objekten:

[source,kotlin]
----
data class BrandSummary(
    val id: String,           // Brand UUID
    val title: String,        // Marken-/Serientitel
    val description: String?  // Kurzbeschreibung
)
----

== TDD-Phasen

=== Phase 1: Red - Unit Tests schreiben (schlagen fehl)

* Teste Aufruf mit Standard-Limit
* Teste leere Ergebnisse
* Teste Fehlerfälle (API-Fehler)
* Teste Limit-Parameter (Standard 10, andere Werte)

=== Phase 2: Red - Integration Tests schreiben (schlagen fehl)

* WireMock für `/cmdm/brands` Endpoint
* Teste Response-Mapping und OAuth2
* Teste mit echtem Beispiel-Response (siehe 2025-12-28T222614.200.json, limit 10)

=== Phase 3: Green - Produktivcode implementieren

* Service, Model und Controller/Tool-Annotation
* API-Aufruf, Mapping, Fehlerbehandlung

=== Phase 4: Refactoring

* Code Cleanup, Logging, KDoc, Testabdeckung prüfen

== API-Details

* Endpoint: `/cmdm/brands`
* Parameter: `limit` (default: 10)
* Response: Liste von Brand-Objekten mit Feldern wie `uuid`, `brandName`, `brandDescription`
